                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on obj_clevrer  (cost=3061.29..68209.37 rows=163207 width=62) (actual time=7.425..29.204 rows=165266 loops=1)
   Recheck Cond: (vid < 300)
   Heap Blocks: exact=2204
   ->  Bitmap Index Scan on idx_obj_clevrer  (cost=0.00..3020.48 rows=163207 width=0) (actual time=7.169..7.170 rows=165266 loops=1)
         Index Cond: (vid < 300)
 Planning Time: 0.493 ms
 Execution Time: 79.799 ms
(7 rows)

CREATE INDEX
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=8323.78..55910.46 rows=308787 width=20) (actual time=34.132..473.256 rows=203308 loops=1)
   Merge Cond: ((o0.vid = o1.vid) AND (o0.fid = o1.fid))
   Join Filter: ((o0.oid <> o2.oid) AND (o0.oid <> o1.oid))
   Rows Removed by Join Filter: 139746
   ->  Sort  (cost=8322.94..8460.66 rows=55089 width=12) (actual time=26.214..27.355 rows=19927 loops=1)
         Sort Key: o0.vid, o0.fid
         Sort Method: quicksort  Memory: 1703kB
         ->  Seq Scan on obj_filtered o0  (cost=0.00..3984.83 rows=55089 width=12) (actual time=0.015..20.468 rows=19927 loops=1)
               Filter: brown((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
               Rows Removed by Filter: 145339
   ->  Materialize  (cost=0.84..40722.79 rows=226469 width=24) (actual time=0.096..370.522 rows=635140 loops=1)
         ->  Merge Join  (cost=0.84..40156.62 rows=226469 width=24) (actual time=0.094..265.034 rows=567800 loops=1)
               Merge Cond: ((o2.vid = o1.vid) AND (o2.fid = o1.fid))
               Join Filter: (far('0.9'::double precision, (o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (o1.oid <> o2.oid))
               Rows Removed by Join Filter: 192266
               ->  Index Scan using idx_obj_filtered on obj_filtered o2  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.075..19.558 rows=165266 loops=1)
               ->  Materialize  (cost=0.42..12396.58 rows=165266 width=140) (actual time=0.004..59.292 rows=760061 loops=1)
                     ->  Index Scan using idx_obj_filtered on obj_filtered o1  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.003..22.798 rows=165266 loops=1)
 Planning Time: 0.358 ms
 Execution Time: 527.708 ms
(20 rows)

CREATE INDEX
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=3058821.77..3058839.57 rows=994 width=24) (actual time=665.485..696.074 rows=198790 loops=1)
   CTE g0_seq
     ->  Recursive Union  (cost=0.00..3053179.73 rows=203318 width=24) (actual time=0.015..520.931 rows=401924 loops=1)
           ->  Seq Scan on g0  (cost=0.00..3328.08 rows=203308 width=24) (actual time=0.012..20.485 rows=203308 loops=1)
           ->  Merge Join  (cost=253680.37..304578.53 rows=1 width=24) (actual time=114.978..174.793 rows=99461 loops=2)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o1_oid = s.o1_oid) AND (g.o2_oid = s.o2_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 2)
                 Rows Removed by Join Filter: 97787
                 ->  Index Only Scan using idx_g0 on g0 g  (cost=0.42..12270.04 rows=203308 width=20) (actual time=0.049..34.023 rows=203308 loops=2)
                       Heap Fetches: 406616
                 ->  Sort  (cost=253679.95..258762.65 rows=2033080 width=24) (actual time=69.850..78.133 rows=201075 loops=2)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o1_oid, s.o2_oid
                       Sort Method: quicksort  Memory: 21675kB
                       ->  WorkTable Scan on g0_seq s  (cost=0.00..40661.60 rows=2033080 width=24) (actual time=0.005..16.243 rows=200962 loops=2)
   ->  Sort  (cost=5642.04..5644.59 rows=1017 width=24) (actual time=665.482..672.283 rows=198790 loops=1)
         Sort Key: g0_seq.vid, g0_seq.fid1, g0_seq.fid2, g0_seq.o0_oid, g0_seq.o1_oid, g0_seq.o2_oid
         Sort Method: quicksort  Memory: 21675kB
         ->  CTE Scan on g0_seq  (cost=0.00..5591.25 rows=1017 width=24) (actual time=235.710..635.823 rows=198790 loops=1)
               Filter: (((fid2 - fid1) + 1) = 2)
               Rows Removed by Filter: 203134
 Planning Time: 0.290 ms
 Execution Time: 754.072 ms
(22 rows)

CREATE INDEX
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Seq Scan on obj_filtered o1  (cost=0.00..3984.83 rows=55089 width=12) (actual time=0.014..23.287 rows=128553 loops=1)
   Filter: topquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
   Rows Removed by Filter: 36713
 Planning Time: 0.050 ms
 Execution Time: 50.437 ms
(5 rows)

CREATE INDEX
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1817104.30..1817116.63 rows=965 width=16) (actual time=512.893..530.235 rows=125510 loops=1)
   CTE g1_seq
     ->  Recursive Union  (cost=0.00..1811626.35 rows=197413 width=16) (actual time=0.022..417.133 rows=380927 loops=1)
           ->  Seq Scan on g1  (cost=0.00..1980.53 rows=128553 width=16) (actual time=0.019..17.151 rows=128553 loops=1)
           ->  Merge Join  (cost=156153.31..180569.76 rows=6886 width=16) (actual time=49.138..91.414 rows=84179 loops=3)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o1_oid = s.o1_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 3)
                 Rows Removed by Join Filter: 41399
                 ->  Index Only Scan using idx_g1 on g1 g  (cost=0.42..6700.71 rows=128553 width=12) (actual time=0.035..19.737 rows=128553 loops=3)
                       Heap Fetches: 385659
                 ->  Sort  (cost=156152.89..159366.72 rows=1285530 width=16) (actual time=32.376..37.929 rows=127024 loops=3)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o1_oid
                       Sort Method: quicksort  Memory: 12878kB
                       ->  WorkTable Scan on g1_seq s  (cost=0.00..25710.60 rows=1285530 width=16) (actual time=0.003..9.206 rows=126976 loops=3)
   ->  Sort  (cost=5477.95..5480.41 rows=987 width=16) (actual time=512.892..517.046 rows=125510 loops=1)
         Sort Key: g1_seq.vid, g1_seq.fid1, g1_seq.fid2, g1_seq.o1_oid
         Sort Method: quicksort  Memory: 8956kB
         ->  CTE Scan on g1_seq  (cost=0.00..5428.86 rows=987 width=16) (actual time=293.123..497.872 rows=125510 loops=1)
               Filter: (((fid2 - fid1) + 1) = 3)
               Rows Removed by Filter: 255417
 Planning Time: 0.265 ms
 Execution Time: 568.520 ms
(22 rows)

CREATE INDEX
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=14021.44..14951.68 rows=8388 width=16) (actual time=55.306..63.241 rows=5752 loops=1)
   Merge Cond: ((o1.vid = o0.vid) AND (o1.fid = o0.fid))
   Join Filter: (rightof((o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2) AND (o0.oid <> o1.oid))
   Rows Removed by Join Filter: 6352
   ->  Sort  (cost=5698.50..5744.41 rows=18363 width=140) (actual time=24.388..25.021 rows=16669 loops=1)
         Sort Key: o1.vid, o1.fid
         Sort Method: quicksort  Memory: 3113kB
         ->  Seq Scan on obj_filtered o1  (cost=0.00..4397.99 rows=18363 width=140) (actual time=0.107..20.305 rows=16669 loops=1)
               Filter: (red((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND topquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2))
               Rows Removed by Filter: 148597
   ->  Sort  (cost=8322.94..8460.66 rows=55089 width=140) (actual time=30.874..32.370 rows=37762 loops=1)
         Sort Key: o0.vid, o0.fid
         Sort Method: quicksort  Memory: 6699kB
         ->  Seq Scan on obj_filtered o0  (cost=0.00..3984.83 rows=55089 width=140) (actual time=0.035..19.304 rows=36713 loops=1)
               Filter: bottomquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
               Rows Removed by Filter: 128553
 Planning Time: 0.125 ms
 Execution Time: 65.926 ms
(18 rows)

CREATE INDEX
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=69835.39..69835.82 rows=28 width=20) (actual time=8.339..9.222 rows=5750 loops=1)
   CTE g2_seq
     ->  Recursive Union  (cost=0.00..69676.23 rows=5762 width=20) (actual time=0.012..6.175 rows=5750 loops=1)
           ->  Seq Scan on g2  (cost=0.00..89.52 rows=5752 width=20) (actual time=0.010..0.504 rows=5752 loops=1)
           ->  Merge Join  (cost=5698.15..6947.15 rows=1 width=20) (actual time=4.463..4.464 rows=0 loops=1)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o1_oid = s.o1_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 1)
                 Rows Removed by Join Filter: 5578
                 ->  Index Only Scan using idx_g2 on g2 g  (cost=0.28..314.56 rows=5752 width=16) (actual time=0.038..0.941 rows=5752 loops=1)
                       Heap Fetches: 5752
                 ->  Sort  (cost=5697.87..5841.67 rows=57520 width=20) (actual time=1.796..2.002 rows=5751 loops=1)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o1_oid
                       Sort Method: quicksort  Memory: 642kB
                       ->  WorkTable Scan on g2_seq s  (cost=0.00..1150.40 rows=57520 width=20) (actual time=0.005..0.574 rows=5750 loops=1)
   ->  Sort  (cost=159.16..159.23 rows=29 width=20) (actual time=8.339..8.535 rows=5750 loops=1)
         Sort Key: g2_seq.vid, g2_seq.fid1, g2_seq.fid2, g2_seq.o0_oid, g2_seq.o1_oid
         Sort Method: quicksort  Memory: 642kB
         ->  CTE Scan on g2_seq  (cost=0.00..158.46 rows=29 width=20) (actual time=0.014..7.253 rows=5750 loops=1)
               Filter: (((fid2 - fid1) + 1) = 1)
 Planning Time: 0.244 ms
 Execution Time: 11.333 ms
(21 rows)

CREATE INDEX
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=49775.13..49973.92 rows=19879 width=20) (actual time=4233.448..4233.864 rows=2257 loops=1)
   Group Key: t0.vid, min(t1.fid2), t0.o0_oid, t0.o1_oid, t0.o2_oid
   ->  HashAggregate  (cost=49327.85..49526.64 rows=19879 width=20) (actual time=4232.339..4232.866 rows=2257 loops=1)
         Group Key: t0.vid, t0.o0_oid, t0.o1_oid, t0.o2_oid
         ->  Merge Join  (cost=33312.49..46728.88 rows=207918 width=20) (actual time=84.674..2911.287 rows=7702179 loops=1)
               Merge Cond: ((t1.vid = t0.vid) AND (t1.o1_oid = t0.o1_oid))
               Join Filter: (t0.fid2 < t1.fid1)
               Rows Removed by Join Filter: 10157813
               ->  Sort  (cost=12563.19..12876.97 rows=125510 width=16) (actual time=30.591..36.317 rows=125510 loops=1)
                     Sort Key: t1.vid, t1.o1_oid
                     Sort Method: quicksort  Memory: 8956kB
                     ->  Seq Scan on g1_seq_view t1  (cost=0.00..1934.10 rows=125510 width=16) (actual time=0.024..10.371 rows=125510 loops=1)
               ->  Sort  (cost=20749.30..21246.28 rows=198790 width=20) (actual time=53.741..716.095 rows=17889805 loops=1)
                     Sort Key: t0.vid, t0.o1_oid
                     Sort Method: quicksort  Memory: 21675kB
                     ->  Seq Scan on g0_seq_view t0  (cost=0.00..3254.90 rows=198790 width=20) (actual time=0.032..18.264 rows=198790 loops=1)
 Planning Time: 0.308 ms
 Execution Time: 4235.907 ms
(18 rows)

CREATE INDEX
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=697.00..697.02 rows=1 width=20) (actual time=3.902..3.915 rows=61 loops=1)
   ->  Sort  (cost=697.00..697.00 rows=1 width=20) (actual time=3.901..3.905 rows=61 loops=1)
         Sort Key: t0.vid, (min(t1.fid2)), t0.o0_oid, t0.o1_oid, t0.o2_oid
         Sort Method: quicksort  Memory: 29kB
         ->  GroupAggregate  (cost=696.96..696.99 rows=1 width=20) (actual time=3.657..3.888 rows=61 loops=1)
               Group Key: t0.vid, t0.o0_oid, t0.o1_oid, t0.o2_oid
               ->  Sort  (cost=696.96..696.97 rows=1 width=20) (actual time=3.642..3.699 rows=1750 loops=1)
                     Sort Key: t0.vid, t0.o0_oid, t0.o1_oid, t0.o2_oid
                     Sort Method: quicksort  Memory: 185kB
                     ->  Merge Join  (cost=616.86..696.95 rows=1 width=20) (actual time=2.189..3.335 rows=1750 loops=1)
                           Merge Cond: ((t0.vid = t1.vid) AND (t0.o0_oid = t1.o0_oid) AND (t0.o1_oid = t1.o1_oid))
                           Join Filter: (t0.fid < t1.fid1)
                           Rows Removed by Join Filter: 588
                           ->  Sort  (cost=163.29..168.93 rows=2257 width=20) (actual time=0.764..0.874 rows=2240 loops=1)
                                 Sort Key: t0.vid, t0.o0_oid, t0.o1_oid
                                 Sort Method: quicksort  Memory: 273kB
                                 ->  Seq Scan on q0 t0  (cost=0.00..37.57 rows=2257 width=20) (actual time=0.008..0.212 rows=2257 loops=1)
                           ->  Sort  (cost=453.57..467.94 rows=5750 width=20) (actual time=1.416..1.658 rows=7350 loops=1)
                                 Sort Key: t1.vid, t1.o0_oid, t1.o1_oid
                                 Sort Method: quicksort  Memory: 642kB
                                 ->  Seq Scan on g2_seq_view t1  (cost=0.00..94.50 rows=5750 width=20) (actual time=0.007..0.522 rows=5750 loops=1)
 Planning Time: 0.236 ms
 Execution Time: 4.502 ms
(23 rows)

CREATE INDEX
 count 
-------
    16
(1 row)

