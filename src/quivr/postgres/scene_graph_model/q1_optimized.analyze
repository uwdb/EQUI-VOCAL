Timing is on.
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on obj_clevrer  (cost=3061.29..68209.37 rows=163207 width=62) (actual time=15.997..72.538 rows=165266 loops=1)
   Recheck Cond: (vid < 300)
   Heap Blocks: exact=2204
   ->  Bitmap Index Scan on idx_obj_clevrer  (cost=0.00..3020.48 rows=163207 width=0) (actual time=15.652..15.654 rows=165266 loops=1)
         Index Cond: (vid < 300)
 Planning Time: 1.100 ms
 Execution Time: 149.536 ms
(7 rows)

Time: 156.296 ms
CREATE INDEX
Time: 112.435 ms
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=80218.46..83306.32 rows=308786 width=20) (actual time=501.672..536.678 rows=61140 loops=1)
   Group Key: o0.vid, o0.fid, o0.oid, o1.oid, o2.oid
   ->  Merge Join  (cost=1.26..76358.64 rows=308786 width=20) (actual time=0.711..439.111 rows=61221 loops=1)
         Merge Cond: ((o2.vid = o0.vid) AND (o2.fid = o0.fid))
         Join Filter: (rightof((o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (o1.oid <> o2.oid) AND (o0.oid <> o2.oid))
         Rows Removed by Join Filter: 154761
         ->  Index Scan using idx_obj_filtered on obj_filtered o2  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.168..18.176 rows=165066 loops=1)
         ->  Materialize  (cost=0.84..40722.79 rows=226469 width=152) (actual time=0.268..347.072 rows=215978 loops=1)
               ->  Merge Join  (cost=0.84..40156.62 rows=226469 width=152) (actual time=0.260..323.406 rows=45322 loops=1)
                     Merge Cond: ((o1.vid = o0.vid) AND (o1.fid = o0.fid))
                     Join Filter: (near('1.05'::double precision, (o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2) AND (o0.oid <> o1.oid))
                     Rows Removed by Join Filter: 714744
                     ->  Index Scan using idx_obj_filtered on obj_filtered o1  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.015..18.669 rows=165266 loops=1)
                     ->  Materialize  (cost=0.42..12396.58 rows=165266 width=140) (actual time=0.014..104.550 rows=760061 loops=1)
                           ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.012..38.168 rows=165266 loops=1)
 Planning Time: 0.650 ms
 Execution Time: 565.345 ms
(17 rows)

Time: 571.563 ms
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 WindowAgg  (cost=6362.54..8185.79 rows=66300 width=24) (actual time=69.560..145.281 rows=61140 loops=1)
   ->  Sort  (cost=6362.54..6528.29 rows=66300 width=20) (actual time=69.444..105.368 rows=61140 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid, fid
         Sort Method: quicksort  Memory: 6313kB
         ->  Seq Scan on g0  (cost=0.00..1053.00 rows=66300 width=20) (actual time=0.040..7.138 rows=61140 loops=1)
 Planning Time: 0.245 ms
 Execution Time: 168.945 ms
(7 rows)

Time: 173.355 ms
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=1312.27..1315.26 rows=299 width=20) (actual time=21.774..22.576 rows=2684 loops=1)
   Group Key: vid, o0_oid, o1_oid, o2_oid
   ->  Seq Scan on g0_windowed t0  (cost=0.00..1308.45 rows=306 width=20) (actual time=0.046..11.016 rows=54075 loops=1)
         Filter: (fid_offset = (fid + 2))
         Rows Removed by Filter: 7065
 Planning Time: 0.442 ms
 Execution Time: 24.755 ms
(7 rows)

Time: 31.291 ms
                                                                                      QUERY PLAN                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=15140.10..15391.74 rows=25164 width=16) (actual time=157.156..167.171 rows=19253 loops=1)
   Group Key: o0.vid, o0.fid, o0.oid, o1.oid
   ->  Merge Join  (cost=14021.44..14888.46 rows=25164 width=16) (actual time=106.760..136.568 rows=19286 loops=1)
         Merge Cond: ((o0.vid = o1.vid) AND (o0.fid = o1.fid))
         Join Filter: (o0.oid <> o1.oid)
         Rows Removed by Join Filter: 5039
         ->  Sort  (cost=5698.50..5744.41 rows=18363 width=12) (actual time=58.468..64.334 rows=42657 loops=1)
               Sort Key: o0.vid, o0.fid
               Sort Method: quicksort  Memory: 3536kB
               ->  Seq Scan on obj_filtered o0  (cost=0.00..4397.99 rows=18363 width=12) (actual time=0.043..40.813 rows=42657 loops=1)
                     Filter: (leftquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND metal((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2))
                     Rows Removed by Filter: 122609
         ->  Sort  (cost=8322.94..8460.66 rows=55089 width=12) (actual time=48.207..50.716 rows=30922 loops=1)
               Sort Key: o1.vid, o1.fid
               Sort Method: quicksort  Memory: 1753kB
               ->  Seq Scan on obj_filtered o1  (cost=0.00..3984.83 rows=55089 width=12) (actual time=0.335..40.113 rows=21005 loops=1)
                     Filter: cyan((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
                     Rows Removed by Filter: 144261
 Planning Time: 0.334 ms
 Execution Time: 176.421 ms
(20 rows)

Time: 205.079 ms
                                                          QUERY PLAN                                                          
------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=1908.62..2133.56 rows=2 width=20) (actual time=11.063..19.111 rows=4073 loops=1)
   Merge Cond: ((t0.vid = t1.vid) AND (t0.o0_oid = t1.o0_oid) AND (t0.o1_oid = t1.o1_oid))
   Join Filter: (t0.fid < t1.fid)
   Rows Removed by Join Filter: 3224
   ->  Sort  (cost=225.76..233.41 rows=3060 width=20) (actual time=1.183..2.136 rows=2678 loops=1)
         Sort Key: t0.vid, t0.o0_oid, t0.o1_oid
         Sort Method: quicksort  Memory: 306kB
         ->  Seq Scan on g0_contiguous t0  (cost=0.00..48.60 rows=3060 width=20) (actual time=0.041..0.421 rows=2684 loops=1)
   ->  Sort  (cost=1682.86..1731.42 rows=19425 width=16) (actual time=9.761..12.212 rows=22445 loops=1)
         Sort Key: t1.vid, t1.o0_oid, t1.o1_oid
         Sort Method: quicksort  Memory: 1671kB
         ->  Seq Scan on g1 t1  (cost=0.00..299.25 rows=19425 width=16) (actual time=0.041..2.860 rows=19253 loops=1)
 Planning Time: 0.359 ms
 Execution Time: 22.069 ms
(14 rows)

Time: 29.048 ms
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 WindowAgg  (cost=337.83..459.38 rows=4420 width=24) (actual time=2.663..4.806 rows=4073 loops=1)
   ->  Sort  (cost=337.83..348.88 rows=4420 width=20) (actual time=2.629..2.877 rows=4073 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid, fid
         Sort Method: quicksort  Memory: 415kB
         ->  Seq Scan on g1_filtered  (cost=0.00..70.20 rows=4420 width=20) (actual time=0.050..0.617 rows=4073 loops=1)
 Planning Time: 0.344 ms
 Execution Time: 8.939 ms
(7 rows)

Time: 14.039 ms
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=87.66..88.16 rows=20 width=20) (actual time=1.403..2.091 rows=94 loops=1)
   Group Key: vid, o0_oid, o1_oid, o2_oid
   ->  Sort  (cost=87.66..87.71 rows=20 width=20) (actual time=1.367..1.537 rows=3979 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid
         Sort Method: quicksort  Memory: 407kB
         ->  Seq Scan on g1_windowed t0  (cost=0.00..87.23 rows=20 width=20) (actual time=0.037..0.773 rows=3979 loops=1)
               Filter: (fid_offset = (fid + 1))
               Rows Removed by Filter: 94
 Planning Time: 0.353 ms
 Execution Time: 3.634 ms
(10 rows)

Time: 8.960 ms
                                                                                                                 QUERY PLAN                                                                                                                 
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=59770.29..62858.16 rows=308787 width=20) (actual time=1471.529..2165.421 rows=666601 loops=1)
   Group Key: o0.vid, o0.fid, o0.oid, o1.oid, o2.oid
   ->  Merge Join  (cost=8323.78..55910.46 rows=308787 width=20) (actual time=173.296..881.978 rows=667338 loops=1)
         Merge Cond: ((o1.vid = o0.vid) AND (o1.fid = o0.fid))
         Join Filter: ((o0.oid <> o1.oid) AND (o1.oid <> o2.oid))
         Rows Removed by Join Filter: 462324
         ->  Sort  (cost=8322.94..8460.66 rows=55089 width=12) (actual time=173.140..198.976 rows=128553 loops=1)
               Sort Key: o1.vid, o1.fid
               Sort Method: quicksort  Memory: 9098kB
               ->  Seq Scan on obj_filtered o1  (cost=0.00..3984.83 rows=55089 width=12) (actual time=0.066..37.445 rows=128553 loops=1)
                     Filter: topquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
                     Rows Removed by Filter: 36713
         ->  Materialize  (cost=0.84..40722.79 rows=226469 width=24) (actual time=0.135..438.335 rows=1130144 loops=1)
               ->  Merge Join  (cost=0.84..40156.62 rows=226469 width=24) (actual time=0.122..332.533 rows=296921 loops=1)
                     Merge Cond: ((o0.vid = o2.vid) AND (o0.fid = o2.fid))
                     Join Filter: (leftof((o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (o0.oid <> o2.oid))
                     Rows Removed by Join Filter: 463145
                     ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.076..21.371 rows=165266 loops=1)
                     ->  Materialize  (cost=0.42..12396.58 rows=165266 width=140) (actual time=0.016..103.661 rows=760061 loops=1)
                           ->  Index Scan using idx_obj_filtered on obj_filtered o2  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.012..56.331 rows=165266 loops=1)
 Planning Time: 0.467 ms
 Execution Time: 2624.586 ms
(22 rows)

Time: 2639.121 ms (00:02.639)
                                                         QUERY PLAN                                                         
----------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=81820.12..90864.13 rows=1 width=20) (actual time=1127.689..1625.770 rows=760 loops=1)
   Merge Cond: ((t0.vid = t1.vid) AND (t0.o0_oid = t1.o0_oid) AND (t0.o1_oid = t1.o1_oid) AND (t0.o2_oid = t1.o2_oid))
   Join Filter: (t0.fid < t1.fid)
   Rows Removed by Join Filter: 793
   ->  Sort  (cost=118.22..122.47 rows=1700 width=20) (actual time=0.092..0.169 rows=94 loops=1)
         Sort Key: t0.vid, t0.o0_oid, t0.o1_oid, t0.o2_oid
         Sort Method: quicksort  Memory: 32kB
         ->  Seq Scan on g1_contiguous t0  (cost=0.00..27.00 rows=1700 width=20) (actual time=0.047..0.055 rows=94 loops=1)
   ->  Sort  (cost=81701.90..83506.45 rows=721820 width=20) (actual time=1117.423..1422.808 rows=662149 loops=1)
         Sort Key: t1.vid, t1.o0_oid, t1.o1_oid, t1.o2_oid
         Sort Method: quicksort  Memory: 76655kB
         ->  Seq Scan on g2 t1  (cost=0.00..11464.20 rows=721820 width=20) (actual time=0.034..208.120 rows=666601 loops=1)
 Planning Time: 0.436 ms
 Execution Time: 1641.235 ms
(14 rows)

Time: 1658.055 ms (00:01.658)
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 WindowAgg  (cost=118.22..164.97 rows=1700 width=24) (actual time=0.571..1.002 rows=760 loops=1)
   ->  Sort  (cost=118.22..122.47 rows=1700 width=20) (actual time=0.541..0.591 rows=760 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid, fid
         Sort Method: quicksort  Memory: 84kB
         ->  Seq Scan on g2_filtered  (cost=0.00..27.00 rows=1700 width=20) (actual time=0.051..0.170 rows=760 loops=1)
 Planning Time: 0.293 ms
 Execution Time: 6.820 ms
(7 rows)

Time: 14.524 ms
                                                       QUERY PLAN                                                       
------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=33.67..33.87 rows=8 width=20) (actual time=0.427..0.563 rows=22 loops=1)
   Group Key: vid, o0_oid, o1_oid, o2_oid
   ->  Sort  (cost=33.67..33.69 rows=8 width=20) (actual time=0.386..0.428 rows=687 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid
         Sort Method: quicksort  Memory: 78kB
         ->  Seq Scan on g2_windowed t0  (cost=0.00..33.55 rows=8 width=20) (actual time=0.085..0.246 rows=687 loops=1)
               Filter: (fid_offset = (fid + 3))
               Rows Removed by Filter: 73
 Planning Time: 0.329 ms
 Execution Time: 6.414 ms
(10 rows)

Time: 14.856 ms
 vid 
-----
 146
  84
  92
 101
 289
 280
 286
 296
   4
  46
 224
 293
  27
(13 rows)

Time: 2.507 ms
