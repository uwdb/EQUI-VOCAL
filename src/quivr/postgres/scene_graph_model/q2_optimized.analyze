Timing is on.
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on obj_clevrer  (cost=3061.29..68209.37 rows=163207 width=62) (actual time=14.898..96.125 rows=165266 loops=1)
   Recheck Cond: (vid < 300)
   Heap Blocks: exact=2204
   ->  Bitmap Index Scan on idx_obj_clevrer  (cost=0.00..3020.48 rows=163207 width=0) (actual time=14.572..14.574 rows=165266 loops=1)
         Index Cond: (vid < 300)
 Planning Time: 3.581 ms
 Execution Time: 185.452 ms
(7 rows)

Time: 196.946 ms
CREATE INDEX
Time: 117.243 ms
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=0.84..40156.62 rows=226469 width=16) (actual time=0.160..307.430 rows=296921 loops=1)
   Merge Cond: ((o0.vid = o1.vid) AND (o0.fid = o1.fid))
   Join Filter: (leftof((o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2) AND (o0.oid <> o1.oid))
   Rows Removed by Join Filter: 463145
   ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.111..20.352 rows=165266 loops=1)
   ->  Materialize  (cost=0.42..12396.58 rows=165266 width=140) (actual time=0.016..85.748 rows=760061 loops=1)
         ->  Index Scan using idx_obj_filtered on obj_filtered o1  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.010..39.223 rows=165266 loops=1)
 Planning Time: 0.643 ms
 Execution Time: 435.246 ms
(9 rows)

Time: 440.904 ms
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 WindowAgg  (cost=31564.35..38987.47 rows=296925 width=20) (actual time=360.641..665.665 rows=296921 loops=1)
   ->  Sort  (cost=31564.35..32306.66 rows=296925 width=16) (actual time=360.572..393.548 rows=296921 loops=1)
         Sort Key: vid, o0_oid, o1_oid, fid
         Sort Method: quicksort  Memory: 26207kB
         ->  Seq Scan on g0  (cost=0.00..4574.25 rows=296925 width=16) (actual time=0.040..61.921 rows=296921 loops=1)
 Planning Time: 0.287 ms
 Execution Time: 820.423 ms
(7 rows)

Time: 828.231 ms
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=6732.68..6748.40 rows=1572 width=16) (actual time=131.598..133.527 rows=3871 loops=1)
   Group Key: vid, o0_oid, o1_oid
   ->  Seq Scan on g0_rownum t0  (cost=0.00..6716.60 rows=1608 width=16) (actual time=0.064..73.619 rows=278052 loops=1)
         Filter: (fid_offset = (fid + 4))
         Rows Removed by Filter: 18869
 Planning Time: 0.634 ms
 Execution Time: 144.296 ms
(7 rows)

Time: 153.633 ms
                                                                                                                        QUERY PLAN                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Nested Loop  (cost=0.84..22508.27 rows=11437 width=20) (actual time=2.855..142.999 rows=10784 loops=1)
   Join Filter: (o1.oid <> o2.oid)
   ->  Nested Loop  (cost=0.42..17559.28 rows=8388 width=152) (actual time=2.822..114.393 rows=8886 loops=1)
         ->  Seq Scan on obj_filtered o2  (cost=0.00..4811.16 rows=6121 width=140) (actual time=2.563..78.723 rows=3779 loops=1)
               Filter: (cyan((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND rightquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND sphere((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2))
               Rows Removed by Filter: 161487
         ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..2.07 rows=1 width=140) (actual time=0.008..0.009 rows=2 loops=3779)
               Index Cond: ((vid = o2.vid) AND (fid = o2.fid))
               Filter: (behind((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (oid <> o2.oid))
               Rows Removed by Filter: 2
   ->  Index Scan using idx_obj_filtered on obj_filtered o1  (cost=0.42..0.58 rows=1 width=140) (actual time=0.002..0.003 rows=1 loops=8886)
         Index Cond: ((vid = o0.vid) AND (fid = o0.fid))
         Filter: (frontof((o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND (o0.oid <> oid))
         Rows Removed by Filter: 4
 Planning Time: 0.513 ms
 Execution Time: 254.969 ms
(16 rows)

Time: 269.151 ms
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=1270.59..1426.82 rows=2 width=20) (actual time=5.974..9.789 rows=5874 loops=1)
   Merge Cond: ((g0_seq.vid = g1.vid) AND (g0_seq.o0_oid = g1.o0_oid) AND (g0_seq.o1_oid = g1.o1_oid))
   Join Filter: (g1.fid > g0_seq.fid)
   Rows Removed by Join Filter: 1027
   ->  Sort  (cost=291.47..301.18 rows=3885 width=16) (actual time=1.766..2.469 rows=3859 loops=1)
         Sort Key: g0_seq.vid, g0_seq.o0_oid, g0_seq.o1_oid
         Sort Method: quicksort  Memory: 278kB
         ->  Seq Scan on g0_seq  (cost=0.00..59.85 rows=3885 width=16) (actual time=0.072..0.557 rows=3871 loops=1)
   ->  Sort  (cost=979.13..1008.45 rows=11730 width=20) (actual time=4.064..5.040 rows=10784 loops=1)
         Sort Key: g1.vid, g1.o0_oid, g1.o1_oid
         Sort Method: quicksort  Memory: 1227kB
         ->  Seq Scan on g1  (cost=0.00..186.30 rows=11730 width=20) (actual time=0.034..1.363 rows=10784 loops=1)
 Planning Time: 0.392 ms
 Execution Time: 29.394 ms
(14 rows)

Time: 58.758 ms
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 WindowAgg  (cost=511.43..689.08 rows=6460 width=24) (actual time=3.956..7.291 rows=5874 loops=1)
   ->  Sort  (cost=511.43..527.58 rows=6460 width=20) (actual time=3.915..4.428 rows=5874 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid, fid
         Sort Method: quicksort  Memory: 651kB
         ->  Seq Scan on g1_filtered  (cost=0.00..102.60 rows=6460 width=20) (actual time=0.074..0.823 rows=5874 loops=1)
 Planning Time: 0.318 ms
 Execution Time: 23.771 ms
(7 rows)

Time: 36.922 ms
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=128.23..128.97 rows=29 width=20) (actual time=2.314..3.374 rows=128 loops=1)
   Group Key: vid, o0_oid, o1_oid, o2_oid
   ->  Sort  (cost=128.23..128.30 rows=30 width=20) (actual time=2.278..2.540 rows=5874 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid
         Sort Method: quicksort  Memory: 651kB
         ->  Seq Scan on g1_rownum t0  (cost=0.00..127.49 rows=30 width=20) (actual time=0.080..1.220 rows=5874 loops=1)
               Filter: (fid_offset = (fid + 0))
 Planning Time: 0.346 ms
 Execution Time: 21.803 ms
(9 rows)

Time: 33.740 ms
                                                      QUERY PLAN                                                       
-----------------------------------------------------------------------------------------------------------------------
 Seq Scan on obj_filtered o2  (cost=0.00..3984.83 rows=55089 width=12) (actual time=0.079..115.462 rows=83139 loops=1)
   Filter: rightquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
   Rows Removed by Filter: 82127
 Planning Time: 0.178 ms
 Execution Time: 217.304 ms
(5 rows)

Time: 251.521 ms
                                                     QUERY PLAN                                                      
---------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=9053.39..9803.41 rows=1300 width=20) (actual time=85.968..113.993 rows=7274 loops=1)
   Merge Cond: ((g1_seq.vid = g2.vid) AND (g1_seq.o2_oid = g2.o2_oid))
   Join Filter: (g2.fid > g1_seq.fid)
   Rows Removed by Join Filter: 3803
   ->  Sort  (cost=118.22..122.47 rows=1700 width=20) (actual time=0.159..0.181 rows=128 loops=1)
         Sort Key: g1_seq.vid, g1_seq.o2_oid
         Sort Method: quicksort  Memory: 35kB
         ->  Seq Scan on g1_seq  (cost=0.00..27.00 rows=1700 width=20) (actual time=0.087..0.103 rows=128 loops=1)
   ->  Sort  (cost=8935.17..9164.67 rows=91800 width=12) (actual time=85.167..92.470 rows=89740 loops=1)
         Sort Key: g2.vid, g2.o2_oid
         Sort Method: quicksort  Memory: 6970kB
         ->  Seq Scan on g2  (cost=0.00..1368.00 rows=91800 width=12) (actual time=0.026..55.012 rows=83139 loops=1)
 Planning Time: 0.417 ms
 Execution Time: 175.180 ms
(14 rows)

Time: 180.841 ms
                                                        QUERY PLAN                                                        
--------------------------------------------------------------------------------------------------------------------------
 WindowAgg  (cost=644.81..864.54 rows=7990 width=24) (actual time=8.019..12.850 rows=7274 loops=1)
   ->  Sort  (cost=644.81..664.79 rows=7990 width=20) (actual time=7.960..8.888 rows=7274 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid, fid
         Sort Method: quicksort  Memory: 761kB
         ->  Seq Scan on g2_filtered  (cost=0.00..126.90 rows=7990 width=20) (actual time=0.065..1.196 rows=7274 loops=1)
 Planning Time: 0.275 ms
 Execution Time: 62.352 ms
(7 rows)

Time: 68.868 ms
                                                       QUERY PLAN                                                        
-------------------------------------------------------------------------------------------------------------------------
 GroupAggregate  (cost=158.65..159.56 rows=36 width=20) (actual time=2.917..4.215 rows=113 loops=1)
   Group Key: vid, o0_oid, o1_oid, o2_oid
   ->  Sort  (cost=158.65..158.74 rows=37 width=20) (actual time=2.888..3.222 rows=7046 loops=1)
         Sort Key: vid, o0_oid, o1_oid, o2_oid
         Sort Method: quicksort  Memory: 743kB
         ->  Seq Scan on g2_rownum t0  (cost=0.00..157.69 rows=37 width=20) (actual time=0.077..1.717 rows=7046 loops=1)
               Filter: (fid_offset = (fid + 2))
               Rows Removed by Filter: 228
 Planning Time: 0.475 ms
 Execution Time: 7.405 ms
(10 rows)

Time: 13.549 ms
 vid 
-----
  12
  23
  24
  26
  30
  32
  52
  65
  79
  82
  91
  93
 100
 108
 110
 126
 134
 151
 168
 178
 183
 194
 218
 221
 224
 228
 239
 260
 261
 294
(30 rows)

Time: 1.180 ms
