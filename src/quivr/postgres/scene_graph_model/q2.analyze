                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on obj_clevrer  (cost=3061.29..68209.37 rows=163207 width=62) (actual time=7.130..28.697 rows=165266 loops=1)
   Recheck Cond: (vid < 300)
   Heap Blocks: exact=2204
   ->  Bitmap Index Scan on idx_obj_clevrer  (cost=0.00..3020.48 rows=163207 width=0) (actual time=6.909..6.910 rows=165266 loops=1)
         Index Cond: (vid < 300)
 Planning Time: 0.470 ms
 Execution Time: 77.287 ms
(7 rows)

CREATE INDEX
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=0.84..40156.62 rows=226469 width=16) (actual time=0.057..223.603 rows=296921 loops=1)
   Merge Cond: ((o0.vid = o1.vid) AND (o0.fid = o1.fid))
   Join Filter: (leftof((o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2) AND (o0.oid <> o1.oid))
   Rows Removed by Join Filter: 463145
   ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.037..16.421 rows=165266 loops=1)
   ->  Materialize  (cost=0.42..12396.58 rows=165266 width=140) (actual time=0.007..54.434 rows=760061 loops=1)
         ->  Index Scan using idx_obj_filtered on obj_filtered o1  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.005..20.206 rows=165266 loops=1)
 Planning Time: 0.250 ms
 Execution Time: 297.459 ms
(9 rows)

CREATE INDEX
                                                                      QUERY PLAN                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=4442006.92..4442029.33 rows=1461 width=20) (actual time=2330.147..2370.820 rows=278427 loops=1)
   CTE g0_seq
     ->  Recursive Union  (cost=0.00..4433712.22 rows=298761 width=20) (actual time=0.016..1948.382 rows=1435744 loops=1)
           ->  Seq Scan on g0  (cost=0.00..4574.21 rows=296921 width=20) (actual time=0.014..26.567 rows=296921 loops=1)
           ->  Merge Join  (cost=378599.16..442316.28 rows=184 width=20) (actual time=99.899..236.484 rows=227959 loops=5)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o1_oid = s.o1_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 5)
                 Rows Removed by Join Filter: 54914
                 ->  Index Only Scan using idx_g0 on g0 g  (cost=0.42..15458.24 rows=296921 width=16) (actual time=0.035..50.140 rows=296921 loops=5)
                       Heap Fetches: 1484605
                 ->  Sort  (cost=378598.74..386021.76 rows=2969210 width=20) (actual time=75.833..89.705 rows=287319 loops=5)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o1_oid
                       Sort Method: quicksort  Memory: 34041kB
                       ->  WorkTable Scan on g0_seq s  (cost=0.00..59384.20 rows=2969210 width=20) (actual time=0.003..23.747 rows=287149 loops=5)
   ->  Sort  (cost=8294.70..8298.43 rows=1494 width=20) (actual time=2330.145..2339.921 rows=278427 loops=1)
         Sort Key: g0_seq.vid, g0_seq.fid1, g0_seq.fid2, g0_seq.o0_oid, g0_seq.o1_oid
         Sort Method: quicksort  Memory: 34041kB
         ->  CTE Scan on g0_seq  (cost=0.00..8215.93 rows=1494 width=20) (actual time=1793.859..2294.740 rows=278427 loops=1)
               Filter: (((fid2 - fid1) + 1) = 5)
               Rows Removed by Filter: 1157317
 Planning Time: 0.275 ms
 Execution Time: 2462.700 ms
(22 rows)

CREATE INDEX
                                                                                                                        QUERY PLAN                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Nested Loop  (cost=0.84..22508.27 rows=11437 width=20) (actual time=1.347..49.621 rows=10784 loops=1)
   Join Filter: (o1.oid <> o2.oid)
   ->  Nested Loop  (cost=0.42..17559.28 rows=8388 width=152) (actual time=1.338..30.147 rows=8886 loops=1)
         ->  Seq Scan on obj_filtered o2  (cost=0.00..4811.16 rows=6121 width=140) (actual time=1.213..21.122 rows=3779 loops=1)
               Filter: (cyan((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND rightquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND sphere((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2))
               Rows Removed by Filter: 161487
         ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..2.07 rows=1 width=140) (actual time=0.001..0.002 rows=2 loops=3779)
               Index Cond: ((vid = o2.vid) AND (fid = o2.fid))
               Filter: (behind((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (oid <> o2.oid))
               Rows Removed by Filter: 2
   ->  Index Scan using idx_obj_filtered on obj_filtered o1  (cost=0.42..0.58 rows=1 width=140) (actual time=0.001..0.002 rows=1 loops=8886)
         Index Cond: ((vid = o0.vid) AND (fid = o0.fid))
         Filter: (frontof((o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND (o0.oid <> oid))
         Rows Removed by Filter: 4
 Planning Time: 0.216 ms
 Execution Time: 53.622 ms
(16 rows)

CREATE INDEX
                                                                        QUERY PLAN                                                                        
----------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=139515.66..139516.61 rows=53 width=24) (actual time=18.451..20.209 rows=10784 loops=1)
   CTE g1_seq
     ->  Recursive Union  (cost=0.00..139217.27 rows=10794 width=24) (actual time=0.013..12.924 rows=10784 loops=1)
           ->  Seq Scan on g1  (cost=0.00..176.84 rows=10784 width=24) (actual time=0.012..1.036 rows=10784 loops=1)
           ->  Merge Join  (cost=11171.72..13882.46 rows=1 width=24) (actual time=9.201..9.202 rows=0 loops=1)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o1_oid = s.o1_oid) AND (g.o2_oid = s.o2_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 1)
                 Rows Removed by Join Filter: 10526
                 ->  Index Only Scan using idx_g1 on g1 g  (cost=0.29..662.05 rows=10784 width=20) (actual time=0.037..1.704 rows=10784 loops=1)
                       Heap Fetches: 10784
                 ->  Sort  (cost=11171.43..11441.03 rows=107840 width=24) (actual time=4.186..4.541 rows=10784 loops=1)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o1_oid, s.o2_oid
                       Sort Method: quicksort  Memory: 1227kB
                       ->  WorkTable Scan on g1_seq s  (cost=0.00..2156.80 rows=107840 width=24) (actual time=0.007..0.863 rows=10784 loops=1)
   ->  Sort  (cost=298.39..298.52 rows=54 width=24) (actual time=18.450..18.817 rows=10784 loops=1)
         Sort Key: g1_seq.vid, g1_seq.fid1, g1_seq.fid2, g1_seq.o0_oid, g1_seq.o1_oid, g1_seq.o2_oid
         Sort Method: quicksort  Memory: 1227kB
         ->  CTE Scan on g1_seq  (cost=0.00..296.84 rows=54 width=24) (actual time=0.015..15.137 rows=10784 loops=1)
               Filter: (((fid2 - fid1) + 1) = 1)
 Planning Time: 0.242 ms
 Execution Time: 23.947 ms
(21 rows)

CREATE INDEX
                                                      QUERY PLAN                                                      
----------------------------------------------------------------------------------------------------------------------
 Seq Scan on obj_filtered o2  (cost=0.00..3984.83 rows=55089 width=12) (actual time=0.011..21.472 rows=83139 loops=1)
   Filter: rightquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
   Rows Removed by Filter: 82127
 Planning Time: 0.037 ms
 Execution Time: 38.505 ms
(5 rows)

CREATE INDEX
                                                                    QUERY PLAN                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1147517.84..1147524.84 rows=548 width=16) (actual time=319.123..334.630 rows=80801 loops=1)
   CTE g2_seq
     ->  Recursive Union  (cost=0.00..1144413.96 rows=111939 width=16) (actual time=0.014..263.161 rows=245803 loops=1)
           ->  Seq Scan on g2  (cost=0.00..1281.39 rows=83139 width=16) (actual time=0.012..7.071 rows=83139 loops=1)
           ->  Merge Join  (cost=98375.33..114089.38 rows=2880 width=16) (actual time=31.273..58.613 rows=54249 loops=3)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o2_oid = s.o2_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 3)
                 Rows Removed by Join Filter: 26591
                 ->  Index Only Scan using idx_g2 on g2 g  (cost=0.42..4339.50 rows=83139 width=12) (actual time=0.031..12.793 rows=83139 loops=3)
                       Heap Fetches: 249417
                 ->  Sort  (cost=98374.91..100453.39 rows=831390 width=16) (actual time=20.241..23.663 rows=81958 loops=3)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o2_oid
                       Sort Method: quicksort  Memory: 9385kB
                       ->  WorkTable Scan on g2_seq s  (cost=0.00..16627.80 rows=831390 width=16) (actual time=0.004..5.867 rows=81934 loops=3)
   ->  Sort  (cost=3103.88..3105.28 rows=560 width=16) (actual time=319.122..326.000 rows=80801 loops=1)
         Sort Key: g2_seq.vid, g2_seq.fid1, g2_seq.fid2, g2_seq.o2_oid
         Sort Method: quicksort  Memory: 6860kB
         ->  CTE Scan on g2_seq  (cost=0.00..3078.32 rows=560 width=16) (actual time=176.776..311.377 rows=80801 loops=1)
               Filter: (((fid2 - fid1) + 1) = 3)
               Rows Removed by Filter: 165002
 Planning Time: 0.225 ms
 Execution Time: 353.858 ms
(22 rows)

CREATE INDEX
                                                                        QUERY PLAN                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=33545.55..33547.42 rows=125 width=20) (actual time=283.910..283.938 rows=128 loops=1)
   ->  Sort  (cost=33545.55..33545.86 rows=125 width=20) (actual time=283.908..283.917 rows=128 loops=1)
         Sort Key: t0.vid, (min(t1.fid2)), t0.o0_oid, t0.o1_oid, t1.o2_oid
         Sort Method: quicksort  Memory: 35kB
         ->  GroupAggregate  (cost=33538.07..33541.19 rows=125 width=20) (actual time=244.373..283.867 rows=128 loops=1)
               Group Key: t0.vid, t0.o0_oid, t0.o1_oid, t1.o2_oid
               ->  Sort  (cost=33538.07..33538.38 rows=125 width=20) (actual time=244.335..253.720 rows=296786 loops=1)
                     Sort Key: t0.vid, t0.o0_oid, t0.o1_oid, t1.o2_oid
                     Sort Method: quicksort  Memory: 35475kB
                     ->  Merge Join  (cost=30636.92..33533.71 rows=125 width=20) (actual time=87.018..198.232 rows=296786 loops=1)
                           Merge Cond: ((t0.vid = t1.vid) AND (t0.o0_oid = t1.o0_oid) AND (t0.o1_oid = t1.o1_oid))
                           Join Filter: (t0.fid2 < t1.fid1)
                           Rows Removed by Join Filter: 253137
                           ->  Sort  (cost=29737.73..30433.80 rows=278427 width=16) (actual time=81.751..93.090 rows=277681 loops=1)
                                 Sort Key: t0.vid, t0.o0_oid, t0.o1_oid
                                 Sort Method: quicksort  Memory: 25340kB
                                 ->  Seq Scan on g0_seq_view t0  (cost=0.00..4558.27 rows=278427 width=16) (actual time=0.012..24.319 rows=278427 loops=1)
                           ->  Sort  (cost=899.18..926.14 rows=10784 width=24) (actual time=3.710..21.930 rows=553806 loops=1)
                                 Sort Key: t1.vid, t1.o0_oid, t1.o1_oid
                                 Sort Method: quicksort  Memory: 1227kB
                                 ->  Seq Scan on g1_seq_view t1  (cost=0.00..176.84 rows=10784 width=24) (actual time=0.037..1.068 rows=10784 loops=1)
 Planning Time: 0.328 ms
 Execution Time: 284.771 ms
(23 rows)

CREATE INDEX
                                                                              QUERY PLAN                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=1157.96..1159.25 rows=86 width=20) (actual time=4.615..4.637 rows=113 loops=1)
   ->  Sort  (cost=1157.96..1158.17 rows=86 width=20) (actual time=4.614..4.620 rows=113 loops=1)
         Sort Key: t0.vid, (min(t1.fid2)), t0.o0_oid, t0.o2_oid, t0.o1_oid
         Sort Method: quicksort  Memory: 33kB
         ->  GroupAggregate  (cost=1153.04..1155.19 rows=86 width=20) (actual time=3.645..4.591 rows=113 loops=1)
               Group Key: t0.vid, t0.o0_oid, t0.o2_oid, t0.o1_oid
               ->  Sort  (cost=1153.04..1153.26 rows=86 width=20) (actual time=3.635..3.858 rows=7046 loops=1)
                     Sort Key: t0.vid, t0.o0_oid, t0.o2_oid, t0.o1_oid
                     Sort Method: quicksort  Memory: 743kB
                     ->  Nested Loop  (cost=0.42..1150.28 rows=86 width=20) (actual time=0.050..2.318 rows=7046 loops=1)
                           ->  Seq Scan on q0 t0  (cost=0.00..2.28 rows=128 width=20) (actual time=0.007..0.015 rows=128 loops=1)
                           ->  Index Only Scan using idx_g2_seq_view on g2_seq_view t1  (cost=0.42..8.96 rows=1 width=16) (actual time=0.005..0.014 rows=55 loops=128)
                                 Index Cond: ((vid = t0.vid) AND (fid1 > t0.fid) AND (o2_oid = t0.o2_oid))
                                 Heap Fetches: 7046
 Planning Time: 0.238 ms
 Execution Time: 5.430 ms
(16 rows)

CREATE INDEX
 count 
-------
    30
(1 row)

