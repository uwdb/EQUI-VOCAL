                                                             QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 Bitmap Heap Scan on obj_clevrer  (cost=3061.29..68209.37 rows=163207 width=62) (actual time=7.187..29.001 rows=165266 loops=1)
   Recheck Cond: (vid < 300)
   Heap Blocks: exact=2204
   ->  Bitmap Index Scan on idx_obj_clevrer  (cost=0.00..3020.48 rows=163207 width=0) (actual time=6.969..6.970 rows=165266 loops=1)
         Index Cond: (vid < 300)
 Planning Time: 0.483 ms
 Execution Time: 87.894 ms
(7 rows)

CREATE INDEX
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=16645.88..18766.12 rows=25164 width=16) (actual time=87.649..112.202 rows=5132 loops=1)
   Merge Cond: ((o0.vid = o1.vid) AND (o0.fid = o1.fid))
   Join Filter: (near('1.05'::double precision, (o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o1.shape)::text, (o1.color)::text, (o1.material)::text, o1.x1, o1.y1, o1.x2, o1.y2) AND (o0.oid <> o1.oid))
   Rows Removed by Join Filter: 58461
   ->  Sort  (cost=8322.94..8460.66 rows=55089 width=140) (actual time=43.849..45.801 rows=50045 loops=1)
         Sort Key: o0.vid, o0.fid
         Sort Method: quicksort  Memory: 8574kB
         ->  Seq Scan on obj_filtered o0  (cost=0.00..3984.83 rows=55089 width=140) (actual time=0.013..23.845 rows=50045 loops=1)
               Filter: cube((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
               Rows Removed by Filter: 115221
   ->  Sort  (cost=8322.94..8460.66 rows=55089 width=140) (actual time=43.734..46.674 rows=75717 loops=1)
         Sort Key: o1.vid, o1.fid
         Sort Method: quicksort  Memory: 9296kB
         ->  Seq Scan on obj_filtered o1  (cost=0.00..3984.83 rows=55089 width=140) (actual time=0.036..27.129 rows=55180 loops=1)
               Filter: sphere((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2)
               Rows Removed by Filter: 110086
 Planning Time: 0.243 ms
 Execution Time: 116.652 ms
(18 rows)

CREATE INDEX
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=61851.28..61851.67 rows=25 width=20) (actual time=7.506..8.303 rows=5132 loops=1)
   CTE g0_seq
     ->  Recursive Union  (cost=0.00..61709.26 rows=5142 width=20) (actual time=0.012..5.301 rows=5132 loops=1)
           ->  Seq Scan on g0  (cost=0.00..79.32 rows=5132 width=20) (actual time=0.010..0.480 rows=5132 loops=1)
           ->  Merge Join  (cost=5041.76..6152.71 rows=1 width=20) (actual time=3.643..3.644 rows=0 loops=1)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o1_oid = s.o1_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 1)
                 Rows Removed by Join Filter: 4865
                 ->  Index Only Scan using idx_g0 on g0 g  (cost=0.28..277.26 rows=5132 width=16) (actual time=0.036..0.836 rows=5132 loops=1)
                       Heap Fetches: 5132
                 ->  Sort  (cost=5041.48..5169.78 rows=51320 width=20) (actual time=1.427..1.602 rows=5132 loops=1)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o1_oid
                       Sort Method: quicksort  Memory: 593kB
                       ->  WorkTable Scan on g0_seq s  (cost=0.00..1026.40 rows=51320 width=20) (actual time=0.004..0.381 rows=5132 loops=1)
   ->  Sort  (cost=142.02..142.08 rows=26 width=20) (actual time=7.506..7.679 rows=5132 loops=1)
         Sort Key: g0_seq.vid, g0_seq.fid1, g0_seq.fid2, g0_seq.o0_oid, g0_seq.o1_oid
         Sort Method: quicksort  Memory: 593kB
         ->  CTE Scan on g0_seq  (cost=0.00..141.41 rows=26 width=20) (actual time=0.014..6.526 rows=5132 loops=1)
               Filter: (((fid2 - fid1) + 1) = 1)
 Planning Time: 0.257 ms
 Execution Time: 10.756 ms
(21 rows)

CREATE INDEX
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=0.84..40156.62 rows=226469 width=16) (actual time=0.204..230.421 rows=45322 loops=1)
   Merge Cond: ((o2.vid = o0.vid) AND (o2.fid = o0.fid))
   Join Filter: (near('1.05'::double precision, (o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (o0.oid <> o2.oid))
   Rows Removed by Join Filter: 714744
   ->  Index Scan using idx_obj_filtered on obj_filtered o2  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.051..14.854 rows=165266 loops=1)
   ->  Materialize  (cost=0.42..12396.58 rows=165266 width=140) (actual time=0.006..57.227 rows=760061 loops=1)
         ->  Index Scan using idx_obj_filtered on obj_filtered o0  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.005..23.169 rows=165266 loops=1)
 Planning Time: 0.133 ms
 Execution Time: 242.706 ms
(9 rows)

CREATE INDEX
                                                                    QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=616594.36..616597.76 rows=222 width=20) (actual time=79.850..87.301 rows=45238 loops=1)
   CTE g1_seq
     ->  Recursive Union  (cost=0.00..615338.02 rows=45362 width=20) (actual time=0.012..55.170 rows=45238 loops=1)
           ->  Seq Scan on g1  (cost=0.00..698.22 rows=45322 width=20) (actual time=0.011..4.274 rows=45322 loops=1)
           ->  Merge Join  (cost=51644.37..61373.26 rows=4 width=20) (actual time=37.479..37.481 rows=0 loops=1)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o2_oid = s.o2_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 1)
                 Rows Removed by Join Filter: 42742
                 ->  Index Only Scan using idx_g1 on g1 g  (cost=0.29..2364.12 rows=45322 width=16) (actual time=0.065..7.024 rows=45322 loops=1)
                       Heap Fetches: 45322
                 ->  Sort  (cost=51644.08..52777.13 rows=453220 width=20) (actual time=17.320..18.899 rows=45321 loops=1)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o2_oid
                       Sort Method: quicksort  Memory: 5071kB
                       ->  WorkTable Scan on g1_seq s  (cost=0.00..9064.40 rows=453220 width=20) (actual time=0.008..3.534 rows=45238 loops=1)
   ->  Sort  (cost=1256.34..1256.91 rows=227 width=20) (actual time=79.849..81.397 rows=45238 loops=1)
         Sort Key: g1_seq.vid, g1_seq.fid1, g1_seq.fid2, g1_seq.o0_oid, g1_seq.o2_oid
         Sort Method: quicksort  Memory: 5071kB
         ->  CTE Scan on g1_seq  (cost=0.00..1247.46 rows=227 width=20) (actual time=0.014..66.709 rows=45238 loops=1)
               Filter: (((fid2 - fid1) + 1) = 1)
 Planning Time: 0.263 ms
 Execution Time: 101.904 ms
(21 rows)

CREATE INDEX
                                                                                                                    QUERY PLAN                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=5698.92..20215.30 rows=25163 width=16) (actual time=27.037..82.149 rows=3638 loops=1)
   Merge Cond: ((o2.vid = o0.vid) AND (o2.fid = o0.fid))
   Join Filter: (near('1.05'::double precision, (o0.shape)::text, (o0.color)::text, (o0.material)::text, o0.x1, o0.y1, o0.x2, o0.y2, (o2.shape)::text, (o2.color)::text, (o2.material)::text, o2.x1, o2.y1, o2.x2, o2.y2) AND (o0.oid <> o2.oid))
   Rows Removed by Join Filter: 84333
   ->  Index Scan using idx_obj_filtered on obj_filtered o2  (cost=0.42..11983.41 rows=165266 width=140) (actual time=0.011..15.613 rows=165266 loops=1)
   ->  Sort  (cost=5698.50..5744.41 rows=18363 width=140) (actual time=25.985..28.937 rows=87966 loops=1)
         Sort Key: o0.vid, o0.fid
         Sort Method: quicksort  Memory: 3449kB
         ->  Seq Scan on obj_filtered o0  (cost=0.00..4397.99 rows=18363 width=140) (actual time=0.029..20.024 rows=19059 loops=1)
               Filter: (bottomquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2) AND rightquadrant((shape)::text, (color)::text, (material)::text, x1, y1, x2, y2))
               Rows Removed by Filter: 146207
 Planning Time: 0.142 ms
 Execution Time: 85.630 ms
(13 rows)

CREATE INDEX
                                                                  QUERY PLAN                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=42965.87..42966.14 rows=18 width=20) (actual time=8.284..8.792 rows=3343 loops=1)
   CTE g2_seq
     ->  Recursive Union  (cost=0.00..42865.18 rows=3648 width=20) (actual time=0.013..6.768 rows=6981 loops=1)
           ->  Seq Scan on g2  (cost=0.00..56.38 rows=3638 width=20) (actual time=0.011..0.341 rows=3638 loops=1)
           ->  Merge Join  (cost=3483.82..4273.58 rows=1 width=20) (actual time=1.484..2.401 rows=1672 loops=2)
                 Merge Cond: ((g.vid = s.vid) AND (g.fid = ((s.fid2 + 1))) AND (g.o0_oid = s.o0_oid) AND (g.o2_oid = s.o2_oid))
                 Join Filter: (((g.fid - s.fid1) + 1) <= 2)
                 Rows Removed by Join Filter: 1543
                 ->  Index Only Scan using idx_g2 on g2 g  (cost=0.28..198.85 rows=3638 width=16) (actual time=0.018..0.549 rows=3638 loops=2)
                       Heap Fetches: 7276
                 ->  Sort  (cost=3483.54..3574.49 rows=36380 width=20) (actual time=0.777..0.898 rows=3490 loops=2)
                       Sort Key: s.vid, ((s.fid2 + 1)), s.o0_oid, s.o2_oid
                       Sort Method: quicksort  Memory: 358kB
                       ->  WorkTable Scan on g2_seq s  (cost=0.00..727.60 rows=36380 width=20) (actual time=0.003..0.264 rows=3490 loops=2)
   ->  Sort  (cost=100.70..100.74 rows=18 width=20) (actual time=8.283..8.399 rows=3343 loops=1)
         Sort Key: g2_seq.vid, g2_seq.fid1, g2_seq.fid2, g2_seq.o0_oid, g2_seq.o2_oid
         Sort Method: quicksort  Memory: 358kB
         ->  CTE Scan on g2_seq  (cost=0.00..100.32 rows=18 width=20) (actual time=2.760..8.025 rows=3343 loops=1)
               Filter: (((fid2 - fid1) + 1) = 2)
               Rows Removed by Filter: 3638
 Planning Time: 0.259 ms
 Execution Time: 10.650 ms
(22 rows)

CREATE INDEX
                                                                QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=5158.10..5177.45 rows=1935 width=20) (actual time=93.025..93.078 rows=366 loops=1)
   Group Key: t0.vid, min(t1.fid2), t0.o0_oid, t0.o1_oid, t1.o2_oid
   ->  HashAggregate  (cost=5114.56..5133.91 rows=1935 width=20) (actual time=92.880..92.942 rows=366 loops=1)
         Group Key: t0.vid, t0.o0_oid, t0.o1_oid, t1.o2_oid
         ->  Merge Join  (cost=4640.05..5090.38 rows=1935 width=20) (actual time=12.799..66.072 rows=172974 loops=1)
               Merge Cond: ((t0.vid = t1.vid) AND (t0.o0_oid = t1.o0_oid))
               Join Filter: (t0.fid2 < t1.fid1)
               Rows Removed by Join Filter: 170755
               ->  Sort  (cost=400.59..413.42 rows=5132 width=16) (actual time=1.150..1.342 rows=5132 loops=1)
                     Sort Key: t0.vid, t0.o0_oid
                     Sort Method: quicksort  Memory: 433kB
                     ->  Seq Scan on g0_seq_view t0  (cost=0.00..84.32 rows=5132 width=16) (actual time=0.011..0.465 rows=5132 loops=1)
               ->  Sort  (cost=4239.46..4352.56 rows=45238 width=20) (actual time=11.626..24.544 rows=380663 loops=1)
                     Sort Key: t1.vid, t1.o0_oid
                     Sort Method: quicksort  Memory: 5071kB
                     ->  Seq Scan on g1_seq_view t1  (cost=0.00..741.38 rows=45238 width=20) (actual time=0.008..4.177 rows=45238 loops=1)
 Planning Time: 0.289 ms
 Execution Time: 93.899 ms
(18 rows)

CREATE INDEX
                                                                              QUERY PLAN                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Unique  (cost=313.45..313.46 rows=1 width=20) (actual time=0.783..0.793 rows=34 loops=1)
   ->  Sort  (cost=313.45..313.45 rows=1 width=20) (actual time=0.783..0.785 rows=34 loops=1)
         Sort Key: t0.vid, (min(t1.fid2)), t0.o2_oid, t0.o0_oid, t0.o1_oid
         Sort Method: quicksort  Memory: 27kB
         ->  GroupAggregate  (cost=313.41..313.44 rows=1 width=20) (actual time=0.698..0.776 rows=34 loops=1)
               Group Key: t0.vid, t0.o2_oid, t0.o0_oid, t0.o1_oid
               ->  Sort  (cost=313.41..313.41 rows=1 width=20) (actual time=0.693..0.711 rows=544 loops=1)
                     Sort Key: t0.vid, t0.o2_oid, t0.o0_oid, t0.o1_oid
                     Sort Method: quicksort  Memory: 67kB
                     ->  Nested Loop  (cost=0.28..313.40 rows=1 width=20) (actual time=0.043..0.602 rows=544 loops=1)
                           ->  Seq Scan on q0 t0  (cost=0.00..6.66 rows=366 width=20) (actual time=0.007..0.027 rows=366 loops=1)
                           ->  Index Only Scan using idx_g2_seq_view on g2_seq_view t1  (cost=0.28..0.83 rows=1 width=20) (actual time=0.001..0.001 rows=1 loops=366)
                                 Index Cond: ((vid = t0.vid) AND (fid1 > t0.fid) AND (o0_oid = t0.o0_oid) AND (o2_oid = t0.o2_oid))
                                 Heap Fetches: 544
 Planning Time: 0.261 ms
 Execution Time: 1.423 ms
(16 rows)

CREATE INDEX
 count 
-------
    18
(1 row)

